# Общее описание

В настоящем документе описана работа с консольным приложением gs1_gtin_parser. Приложение делает запросы к сервису GS1 Rus по методу GetItemByGTIN по списку GTIN и атрибутов. При этом, если в возвращаемом XML для value искомого атрибута существует ключ в Lst_AttrTOGS1Attr.valueMap, то в качестве значения возвращается соответствующее данному ключу значение. Если для value искомого атрибута НЕ существует valueMap, то в качестве значения возвращается значение параметра value из полученного XML. 

Утилита не требует инсталяции и запускается из командной строки. При запуске утилиты необходимо указать точку получения входных данных: clipboard или file.

Пример команды для запуска из PowerShell для режима clipboard: '.\gs1_gtin_parser.exe clipboard -g'

> **Важно!** Приложение необходимо вызывать в следующем формате ".\gs1_gtin_parser.exe"

Более подробно параметры запуска описаны ниже.

# Параметры запуска
Запуск приложения осуществляется в двух режимах источника получения исходных данных:

- file
- clipborad

| Режим запуска                                                | Тип аргумента                                                | Полный вариант  | Сокращенный вариант                                          | Описание                                                     |
| :----------------------------------------------------------- | :----------------------------------------------------------- | :-------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| file                                                         | Позиционный. Указывается только аргумент, без указания самого параметра. | in_file         |                                                              | Входной файл. Путь допустимо указывать как абсолютный, так и относительный. Модель входных данных может быть представлена в двух видах: 1. Grid (простая таблица с номерами gtin в столбец и запрашиваемыми параметрами представленными в названии столбцов. 2. EAV (Entity Attribute Value) - исходные данные приведены в двух столбцах "GTIN" и "GS1Attr" |
| Позиционный. Указывается только аргумент, без указания самого параметра. | out_file                                                     |                 | `Выходной файл. Путь допустимо указывать как абсолютный, так и относительный. Если файл лежит в той же директории, что и исполняемый файл, то можно указать только его название. Разрешение фалйа должно быть .xlsx` |                                                              |
| Опциональный                                                 | --print                                                      | -p              | `Вывести результат на экран`                                 |                                                              |
| Опциональный                                                 | --no_valueMap                                                | -n              | `Не запрашивать маппинг (valueMap) значения атрибута из БД.` |                                                              |
| Опциональный                                                 | --verbose                                                    | -v              | `Отображает текущий процесс парсинга GS1 RUS`                |                                                              |
| Опциональный                                                 | --eav                                                        | -e              | `Входной файл в EAV формате, т.е. содержит два столбца 'GTIN' и 'GS1Attr. По умолчанию формат - grid` |                                                              |
| Опциональный                                                 | --chunk                                                      | -c              | `Размер чанка (порции выгрузки). Не должен превышать 50`     |                                                              |
| clipborad                                                    | Обязательный                                                 | `--gtins`       | -g                                                           | `Список gtin. Значения указываются через пробел`             |
|                                                              | Обязательный                                                 | --`attributes`  | `-a`                                                         | `Список GS1Attr. Значения указываются через пробел`          |
|                                                              | Опциональный                                                 | --`no_valueMap` | `-n`                                                         | `Не запрашивать маппинг (valueMap) значения атрибута из БД.` |
|                                                              | Опциональный                                                 | --`verbose`     | `-v`                                                         | `Отображать текущий процесс парсинга GS1 RUS`                |
|                                                              | Опциональный                                                 | `--chunk`       | `-c`                                                         | `Размер чанка (порции выгрузки). Не должен превышать 50`     |


# Путь к файлам.
Путь к файлам. допустимо указывать как абсолютный (например D:\\test_out.xlsx) ,
так и относительный. Например ..\\test_out.xlsx (для записи в директорию выше уровнем),
или test\\test_out.xlsx (для записи в директорию ниже уровнем, или test_out.xlsx (для записи в ту же директорию, где лежит исполняемы скрипт